import functools
import warnings
from typing import Any, Callable, TypeVar, Union, cast