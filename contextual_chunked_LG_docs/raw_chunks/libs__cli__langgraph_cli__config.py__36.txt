def docker_tag(
    config: Config,
    base_image: Optional[str] = None,
) -> str:
    base_image = base_image or default_base_image(config)
    if config.get("_INTERNAL_docker_tag"):
        return f"{base_image}:{config['_INTERNAL_docker_tag']}"

    if config.get("node_version") and not config.get("python_version"):
        return f"{base_image}:{config['node_version']}"
    return f"{base_image}:{config['python_version']}"