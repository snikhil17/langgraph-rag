from collections.abc import Iterator
from contextlib import contextmanager
from typing import Union

from psycopg import Connection
from psycopg.rows import DictRow
from psycopg_pool import ConnectionPool