import functools
import sys
import uuid
from typing import (
    Annotated,
    Any,
    Callable,
    ForwardRef,
    Literal,
    Optional,
    TypeVar,
    Union,
)
from unittest.mock import patch

import langsmith
import pytest
from typing_extensions import NotRequired, Required, TypedDict

from langgraph.graph import END, StateGraph
from langgraph.graph.graph import CompiledGraph
from langgraph.utils.config import _is_not_empty
from langgraph.utils.fields import (
    _is_optional_type,
    get_enhanced_type_hints,
    get_field_default,
)
from langgraph.utils.runnable import (
    is_async_callable,
    is_async_generator,
)